日志上报功能, 使用洋葱模型考法，方便添加中间件